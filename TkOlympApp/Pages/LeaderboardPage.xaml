<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="TkOlympApp.Pages.LeaderboardPage"
             xmlns:svc="clr-namespace:TkOlympApp.Services"
             Title="{svc:Translate Leaderboard}">

    <!-- Theme resources removed: use inline AppThemeBinding in setters to avoid nested value errors -->

    <Grid>
        <!-- Main content -->
        <RefreshView x:Name="LeaderboardRefresh" Refreshing="OnLeaderboardRefresh">
            <ScrollView>
                <VerticalStackLayout Padding="20" Spacing="12">

                <StackLayout Spacing="8">
                    <CollectionView x:Name="ScoreboardCollection" ItemsLayout="VerticalList">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Grid Padding="8" ColumnDefinitions="40, *, 80" RowDefinitions="Auto" BackgroundColor="{Binding BackgroundColor}">
                                <Label Text="{Binding RankingDisplay}" Grid.Column="0" VerticalOptions="Center" HorizontalOptions="Center" TextColor="{Binding TextColor}">
                                    <Label.Triggers>
                                            <DataTrigger TargetType="Label" Binding="{Binding IsCurrentUser}" Value="True">
                                                <Setter Property="FontAttributes" Value="Bold" />
                                            </DataTrigger>
                                        </Label.Triggers>
                                </Label>
                                <Label Text="{Binding PersonDisplay}" Grid.Column="1" VerticalOptions="Center" TextColor="{Binding TextColor}">
                                    <Label.Triggers>
                                        <DataTrigger TargetType="Label" Binding="{Binding IsCurrentUser}" Value="True">
                                            <Setter Property="FontAttributes" Value="Bold" />
                                        </DataTrigger>
                                    </Label.Triggers>
                                </Label>
                                <Label Text="{Binding TotalScoreDisplay}" Grid.Column="2" VerticalOptions="Center" HorizontalOptions="End" TextColor="{Binding TextColor}">
                                    <Label.Triggers>
                                        <DataTrigger TargetType="Label" Binding="{Binding IsCurrentUser}" Value="True">
                                            <Setter Property="FontAttributes" Value="Bold" />
                                        </DataTrigger>
                                    </Label.Triggers>
                                </Label>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
                </StackLayout>

                <!-- Raw response view removed -->
                </VerticalStackLayout>
            </ScrollView>
        </RefreshView>

        <!-- Loading indicator (centered) with message -->
        <VerticalStackLayout HorizontalOptions="Center" VerticalOptions="Center" Spacing="6">
            <ActivityIndicator x:Name="LoadingIndicator" IsVisible="False" IsRunning="False" HorizontalOptions="Center" />
            <Label Text="{svc:Translate Leaderboard_Loading}" IsVisible="{Binding Source={x:Reference LoadingIndicator}, Path=IsVisible}" HorizontalOptions="Center" />
        </VerticalStackLayout>

        </Grid>

    </ContentPage>
